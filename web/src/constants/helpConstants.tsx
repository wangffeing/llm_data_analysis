import React from 'react';
import {
  QuestionCircleOutlined,
  DatabaseOutlined,
  FileTextOutlined,
  UploadOutlined,
  MessageOutlined,
  SettingOutlined,
  PlusOutlined,
  BulbOutlined,
  LineChartOutlined,
  SyncOutlined,
  SearchOutlined,
  EyeOutlined,
  RocketOutlined,
  NodeIndexOutlined,
  ExclamationCircleOutlined,
  DashboardOutlined,
  CloudUploadOutlined,
} from '@ant-design/icons';

export interface HelpContent {
  category: string;
  icon: React.ReactNode;
  items: string[];
}

export interface HelpSection {
  title: string;
  icon: React.ReactNode;
  description: string;
  content: HelpContent[];
  tips: string[];
}

export const helpSections: HelpSection[] = [
  {
    title: '快速开始',
    icon: <RocketOutlined />,
    description: '三步快速开始您的数据分析之旅，从数据准备到获得洞察。',
    content: [
      {
        category: '第一步：准备数据源',
        icon: <DatabaseOutlined />,
        items: [
          '🗂️ **选择已有数据源**：点击左侧边栏底部的"选择数据源"按钮，从列表中选择已配置的数据库。',
          '📁 **上传本地文件**：点击输入框左侧的附件图标，上传CSV、Excel或JSON文件（限制10MB）。',
          '⚙️ **创建新数据源**：如需连接新数据库，点击"管理数据源" → "新增数据源"，配置数据库连接。',
          '✅ **确认数据可用**：选择数据源后，底部按钮会显示当前数据源名称，文件上传后会显示数据预览。',
        ],
      },
      {
        category: '第二步：开始分析对话',
        icon: <MessageOutlined />,
        items: [
          '💬 **直接提问**：在输入框中描述您的分析需求，如"分析2024年各产品的销售趋势"。',
          '📋 **使用模板**：点击"选择分析模板"，选择预定义的专业分析模板快速开始。',
          '🎯 **明确目标**：提供具体的分析目标和业务背景，如"我想了解客户流失主要原因"。',
          '📊 **指定输出**：可以要求特定的图表类型，如"用柱状图显示各地区销售对比"。',
        ],
      },
      {
        category: '第三步：查看分析结果',
        icon: <LineChartOutlined />,
        items: [
          '🧠 **观察思维过程**：AI会显示完整的分析思路和代码执行过程，帮助您理解分析逻辑。',
          '📈 **查看图表数据**：分析结果包含可视化图表、数据表格和关键指标统计。',
          '🔄 **深入追问**：基于初步结果继续提问，如"为什么华南地区销售下降？"进行深入分析。',
          '📄 **生成报告**：满意分析结果后，点击"生成报告"获取完整的分析报告文档。',
        ],
      },
      {
        category: '实用分析示例',
        icon: <BulbOutlined />,
        items: [
          '📊 **销售分析**："分析2024年Q1-Q3各产品线的销售表现，找出增长最快的产品"',
          '👥 **客户分析**："分析客户购买行为，识别高价值客户群体的特征"',
          '📈 **趋势预测**："基于历史数据预测下个月的销售额，并分析影响因素"',
          '🔍 **异常检测**："找出销售数据中的异常波动，分析背后的业务原因"',
          '⚖️ **对比分析**："对比不同渠道的转化率和客户获取成本"',
        ],
      },
    ],
    tips: [
      '💡 新手建议：先从简单的描述性分析开始，如"显示销售总额"，再逐步尝试复杂分析。',
      '🎯 提问技巧：问题越具体越好，包含时间范围、分析维度和期望的输出格式。',
      '🔄 迭代优化：如果结果不理想，尝试换个角度提问或提供更多背景信息。',
      '📚 学习资源：查看"智能对话"和"分析模板与实例"章节，学习更多高级分析技巧。',
    ],
  },
  {
    title: '数据源管理',
    icon: <CloudUploadOutlined />,
    description: '配置数据库数据表和本地文件上传，为分析提供可靠的数据基础。',
    content: [
      {
        category: '数据库数据表管理',
        icon: <DatabaseOutlined />,
        items: [
          '🔍 **选择数据源**：在"选择数据源"对话框中搜索、查看和选择已有的数据源。',
          '⚙️ **管理数据源**：点击"管理数据源"进入管理界面，可以编辑、删除或查看数据源详情。',
          '➕ **创建新数据源**：点击"新增数据源"，支持MySQL、SQLite、OpenGauss等多种数据库。',
          '📝 **配置连接信息**：填写数据库地址、端口、用户名、密码等连接参数。',
          '🏷️ **字段映射配置**：为表字段配置中文名称映射，这对AI理解数据结构至关重要。',
        ],
      },
      {
        category: '本地文件上传',
        icon: <UploadOutlined />,
        items: [
          '📁 **支持格式**：CSV（逗号分隔）、Excel（.xlsx/.xls）、JSON结构化数据。',
          '📤 **上传方式**：点击输入框左侧附件图标选择文件，或直接拖拽文件到输入区域。',
          '👀 **数据预览**：上传后自动显示前几行数据，检查列名和数据类型是否正确。',
          '📏 **文件限制**：单个文件大小限制10MB，建议数据行数控制在合理范围内。',
          '🔧 **格式要求**：确保第一行为列名，数据规整无空行，避免合并单元格。',
        ],
      },
      {
        category: '数据质量优化',
        icon: <BulbOutlined />,
        items: [
          '🧹 **数据清洗**：上传前检查并处理缺失值、异常值和重复数据。',
          '📝 **命名规范**：使用有意义的列名，避免特殊字符、空格和中文乱码。',
          '📊 **格式统一**：确保日期格式一致（如YYYY-MM-DD），数字格式规范。',
          '🏷️ **字段描述**：为关键字段添加清晰的中文描述，帮助AI更好理解数据含义。',
          '🔤 **编码设置**：确保文件编码为UTF-8，避免中文显示乱码问题。',
        ],
      },
      {
        category: '最佳实践建议',
        icon: <RocketOutlined />,
        items: [
          '🎯 **数据源命名**：使用简洁明了的名称，如"销售数据库_2024"、"客户信息表"。',
          '📋 **详细描述**：在数据源描述中说明数据的业务含义、更新频率和数据范围。',
          '🔗 **连接测试**：创建数据源后先测试连接，确保数据可正常访问。',
          '🔄 **定期维护**：定期检查数据源连接状态，及时更新过期的连接信息。',
          '📚 **文档记录**：为重要数据源建立数据字典，记录字段含义和业务规则。',
        ],
      },
    ],
    tips: [
      '🔑 数据质量直接影响分析结果，投入时间优化数据准备是值得的。',
      '📊 建议先熟悉数据结构和字段含义，再开始复杂的分析任务。',
      '⚠️ 敏感数据请注意安全，避免在公共环境中上传机密信息。',
    ],
  },
  {
    title: '会话配置',
    icon: <SettingOutlined />,
    description: '个性化配置您的分析会话，优化AI分析体验和性能',
    content: [
      {
        category: '会话管理',
        icon: <PlusOutlined />,
        items: [
          '点击"新建会话"按钮创建新对话，每个会话都有独立的上下文记忆。',
          '建议为不同的分析任务使用独立的会话，避免上下文混乱。',
          '会话会保存您的分析历史和数据上下文。',
        ],
      },
      {
        category: '思维链模式',
        icon: <NodeIndexOutlined />,
        items: [
          '🧠 **完整思维链**: 显示AI的完整分析思路和代码执行过程，更好地理解AI的分析逻辑。',
          '⚡ **简化模式**: 只显示最终步骤，适合快速查看结果。',
          '📊 **可视化思维**: 以流程图形式展示分析逻辑。',
          '复杂的分析任务建议使用"完整模式"，保留思维链有助于学习和复现分析方法。',
        ],
      },
      {
        category: '🚀 快速模式切换',
        icon: <RocketOutlined />,
        items: [
            '⚡ **纯代码模式**：只使用代码解释器，适合快速数据查询和简单分析，响应速度最快',
            '🧠 **完整模式**：启用规划器+代码解释器+接收器，适合复杂分析任务，提供完整思维链',
        ],
      },
      {
        category: '🔧 代码执行配置',
        icon: <SettingOutlined />,
        items: [
            '📦 **Python模块管理**：精确控制AI可使用的Python库，包括：',
            '  • 📊 **数据处理**：pandas, numpy, scipy（数据操作和科学计算）',
            '  • 📈 **可视化**：matplotlib, seaborn, plotly, bokeh（图表生成）',
            '  • 🤖 **机器学习**：sklearn, statsmodels（预测和统计分析）',
            '  • 📁 **文件处理**：openpyxl, xlrd, json（文件读写）',
            '  • 🛠️ **工具库**：datetime, typing, requests（辅助功能）',
            '🔒 **安全控制**：限制模块可防止不安全的代码执行',
        ],
      },
      {
        category: '🔌 插件与扩展',
        icon: <PlusOutlined />,
        items: [
            '🗄️ **SQL数据插件**：sql_pull_data插件支持高效的数据库查询',
            '🗄️ **可视化插件**：gpt_vis_chart插件支持更美观的数据可视化',
            '🗄️ **流程图|思维导图插件**：gpt_vis_diagram插件支持流程图、思维导图的生成和可视化',
            '🎯 **插件管理**：可启用/禁用特定插件，控制AI的功能范围，并加速推理',
        ],
      },
      {
        category: '高级配置',
        icon: <SyncOutlined />,
        items: [
        '🔢 **对话轮数限制**：设置最大内部对话轮数（默认20轮），控制分析深度',
        '📝 **提示压缩**：启用提示压缩可节省token使用，提升响应速度',
        ],
      },
    ],
    tips: [
      '建议为不同的分析任务使用独立的会话。',
      '复杂的分析任务建议使用"完整模式"。',
      '保留思维链有助于学习和复现分析方法。',
    ],
  },
  {
    title: '分析模板与实例',
    icon: <LineChartOutlined />,
    description: '使用预定义模板快速开始专业分析，通过具体实例学习各种分析方法。',
    content: [
      {
        category: '分析模板使用',
        icon: <FileTextOutlined />,
        items: [
          '📋 **选择模板**：点击"选择分析模板"按钮，浏览可用的分析模板列表。',
          '🎯 **模板兼容性**：系统会根据您当前选择的数据源，计算模板的兼容性。',
          '✅ **兼容标识**：绿色"兼容"标签表示数据源包含模板所需的所有关键字段。',
          '⚠️ **需要调整**：橙色"需调整"表示部分匹配，会提示缺少的必需字段。',
          '📊 **匹配度**：匹配度百分比直观显示模板的适用程度。',
          '🚀 **快速开始**：选择模板后会自动生成专业的分析提示语，您可以在此基础上修改。',
        ],
      },
      {
        category: '数据库取数实例',
        icon: <DatabaseOutlined />,
        items: [
          '🔄 **快速取数**：在"会话配置"中，选择"纯代码解释器"工作模式，描述取数任务来完成快速取数。',
          '📊 **基础取数**："请查询2024年1-6月所有产品的销售数据，按月份和产品类别分组"',
          '🔍 **条件筛选**："筛选出销售额大于10万且客户满意度高于4分的订单记录"',
          '📈 **排序取数**："按销售额降序排列，显示前20名销售人员的业绩数据"',
          '🎯 **聚合统计**："计算每个地区的平均客单价、订单总数和客户留存率"',
          '⏰ **时间范围**："提取最近30天内新注册用户的基本信息和行为数据"',
        ],
      },
      {
        category: '分析方法速查：了解现状',
        icon: <EyeOutlined />,
        items: [
          '📊 **描述性分析**："当前销售额是多少？" "客户分布如何？"',
          '📈 **趋势分析**："销售额如何变化？" "用户增长趋势？"',
          '🔍 **对比分析**："哪个地区表现最好？" "产品间差异？"',
          '📉 **波动分析**："绘制折线图分析过去12个月的月度销售趋势，识别季节性规律"',
          '⚡ **异常检测**："找出销售数据中的异常波动点，分析可能的原因"',
        ],
      },
      {
        category: '分析方法速查：知道原因',
        icon: <SearchOutlined />,
        items: [
          '🎯 **归因分析**："销售下降的原因？" "客户流失的原因？"',
          '📊 **相关性分析**："广告投入与销售的关系？"',
          '🔄 **漏斗分析**："用户在哪个环节流失最多？"',
          '🎯 **销售下滑归因**："分析Q3销售额下降15%的主要原因，从产品、渠道、地区等维度分解"',
          '👥 **用户流失归因**："找出导致用户流失率上升的关键因素，分析用户行为路径"',
          '💰 **成本上升归因**："分析运营成本增加的具体原因，识别主要成本驱动因素"',
        ],
      },
      {
        category: '高级分析实例',
        icon: <RocketOutlined />,
        items: [
          '🏆 **对比分析**："对比不同产品线的盈利能力、市场份额和增长潜力"',
          '🌍 **地区对比**："比较华北、华南、华东三个大区的销售表现和客户特征"',
          '📅 **时期对比**："对比疫情前后的业务数据变化，识别影响和机会"',
          '👥 **群体对比**："分析新老客户在购买行为、偏好和价值方面的差异"',
          '📈 **销售预测**："基于历史数据预测下季度各产品的销售额，并给出置信区间"',
          '👤 **客户预测**："预测哪些客户在未来30天内可能流失，计算流失概率"',
          '📦 **库存预测**："根据销售趋势和季节性因素预测各商品的库存需求"',
          '🎯 **目标预测**："基于当前进度预测是否能完成年度销售目标"',
        ],
      },
      {
        category: '数据准备最佳实践',
        icon: <BulbOutlined />,
        items: [
          '📋 **数据清洗**：上传前检查数据完整性，处理缺失值和异常值',
          '📝 **字段命名**：使用有意义的列名，避免特殊字符和空格',
          '📊 **数据格式**：确保日期、数字格式统一，便于AI理解',
          '🏷️ **数据标注**：为关键字段添加清晰的中文描述',
          '📈 **数据量**：建议单次分析数据量控制在合理范围（<10M）',
        ],
      },
    ],
    tips: [
      '🎯 选择与数据最匹配的模板效果最好，模板是高效分析的起点。',
      '📚 实际分析时，建议先从简单的任务开始，逐步深入到复杂分析。',
      '🔄 每种分析类型都可以结合多个维度，获得更全面的洞察。',
      '📊 善用可视化图表，让分析结果更直观易懂。',
      '💡 分析完成后，记得总结关键发现和行动建议，将技术分析转化为业务洞察。',
    ],
  },
  {
    title: '智能对话',
    icon: <MessageOutlined />,
    description: '掌握与AI进行有效数据分析对话的技巧。',
    content: [
      {
        category: '提问技巧示例 (正反对比)',
        icon: <QuestionCircleOutlined />,
        items: [
          '❌ (模糊): "分析一下我的数据。"',
          '✅ (清晰): "使用柱状图，按月度分析2024年每个产品的销售总额。"',
          '❌ (宽泛): "用户怎么样？"',
          '✅ (具体): "找出上个季度流失用户的共同特征，并分析他们主要集中在哪些城市。"',
          '✅ (指定图表): "绘制散点图，分析广告投入和收入之间的关系。"',
        ],
      },
      {
        category: '提问技巧进阶',
        icon: <BulbOutlined />,
        items: [
          '🎯 **SMART原则**: 提问要具体(Specific)、可衡量(Measurable)、可实现(Achievable)',
          '📝 **背景信息**: 提供业务背景，如"数据是通信行业客服接通率数据，想分析接通率变化"',
          '🔍 **分层提问**: 先整体概览，再深入细节，最后总结洞察',
          '📊 **指定输出**: 明确要求图表类型、数据格式或分析维度',
          '🔄 **迭代优化**: 基于初步结果继续追问，逐步深入',
        ],
      },
      {
        category: '提出好问题的艺术',
        icon: <QuestionCircleOutlined />,
        items: [
          '🎯 **从业务目标出发**: "我们想提升客户满意度" → "哪些因素影响客户满意度？"',
          '📊 **可量化的问题**: "销售不好" → "哪个产品线销售下降最多？"',
          '⏰ **时间维度思考**: "对比去年同期" "分析最近3个月趋势"',
          '🔍 **细分维度思考**: "按地区分析" "按客户类型分析"',
        ],
      },
      {
        category: '数据解读技巧',
        icon: <EyeOutlined />,
        items: [
          '📈 **看趋势不看绝对值**: 关注变化方向和幅度',
          '🔄 **寻找异常和拐点**: 数据突变往往有业务原因',
          '⚖️ **对比才有意义**: 同比、环比、行业对比',
          '🎯 **关注业务指标**: 转化率比访问量更重要',
        ],
      },
      {
        category: '高级技巧',
        icon: <RocketOutlined />,
        items: [
          '分步骤提问，引导AI逐步深入分析。',
          '可以要求AI解释它的分析方法或代码。',
          '善用追问来深入挖掘数据背后的洞察。',
        ],
      },
    ],
    tips: [
      '问题越具体，得到的答案越准确。',
      '像与真人分析师对话一样提供背景信息。',
      '如果结果不理想，尝试换一种方式提问。',
    ],
  },
  {
    title: '常见问题',
    icon: <QuestionCircleOutlined />,
    description: '解决您在使用过程中可能遇到的常见问题。',
    content: [
      {
        category: '文件上传失败|文件分析错误怎么办？',
        icon: <UploadOutlined />,
        items: [
          '请检查文件格式是否为支持的 CSV, XLSX  或 JSON.',
          '请确认文件大小没有超过 10MB 的限制。',
          '如果文件包含中文，请确保其编码为 UTF-8。如有中文乱码， 请检查字符集设置、是否存在特殊字符',
          '尝试清理数据，对EXCEL文件，请确保**移除文件中的空行或拆分合并的单元格，保证第一行为列名**。',
        ],
      },
      {
        category: 'AI 分析结果不理想|分析报错？',
        icon: <BulbOutlined />,
        items: [
          '分析步骤中显示"代码执行失败"为正常现象，"数据问题|AI生成的代码问题"都可能会导致代码执行失败，系统会自动读取失败报错并重新生成。',
          '尝试更具体、更明确地描述您的分析需求（参考"智能对话"、"分析模板与实例"中的技巧）。',
          '请检查在数据源管理中，字段的描述和映射是否准确。',
          '可以尝试分步骤提问，引导 AI 进行更深入的探索。',
          '在"会话配置"中，您可以尝试更换 LLM 模型或调整参数。',
        ],
      },
      {
        category: '数据问题',
        icon: <ExclamationCircleOutlined />,
        items: [
          '❌ **数据格式错误**: 检查CSV分隔符、Excel工作表、JSON结构',
          '❌ **sql取数错误**: 检查"数据源管理"中表字段设置是否正确，表字段和字段中文名是否一致，表的描述是否清晰',
          '🔤 **中文乱码**: 确保文件编码为UTF-8、检查字符集设置',
          '📊 **图表显示异常**: 检查数据类型、代码执行和报错，如无问题请尝试在提示中添加"不使用antd插件，直接使用seaborn生成图表",当前AI自动生成的图表可能会有问题。',
          '🔍 **查询结果为空**: 检查筛选条件、数据范围、字段名称',
        ],
      },
      {
        category: '性能问题',
        icon: <DashboardOutlined />,
        items: [
          '🐌 **分析速度慢**: 数据分析助手有大量上下文提示和多智能体交互，分析速度慢为正常现象，可尝试选择更快的模型|限制会话角色来尝试加速',
        ],
      },
    ],
    tips: [
      'AI生成的結果不稳定，遇到问题时，请先尝试刷新页面或新建会话。',
      '保存重要的分析结果，避免意外丢失。',
      '详细的数据描述和清晰的提问是获得高质量分析结果的关键。',
    ],
  },
];